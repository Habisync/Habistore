import{f as A,r as m,j as e}from"./components-DpluEorh.js";import{v as N,j as c,I as p}from"./index-D9Zn7Ol-.js";import{u as L,H as b,c as x,T as o,g as F}from"./Text-DDUC__2Y.js";import{B as v}from"./Button-DLJUwG7J.js";import{P as k}from"./ProductCard-Bay5aLU-.js";import{S as f}from"./Skeleton-CqNp3mmp.js";import{I as w}from"./Icon-D-RzneJA.js";import{L as B}from"./Link-BE_DgB92.js";import{u as C}from"./hooks-AewHZe8F.js";import{f as P}from"./flatten-connection-BTqmuHGw.js";import{I as R}from"./Image-CKmnK2hx.js";import{M as I}from"./Money-EMQwjQIk.js";function E({count:t=4,heading:s="Shop Best Sellers",layout:n="drawer",onClose:a,query:r,reverse:i,sortKey:d="BEST_SELLING"}){const{load:u,data:l}=A(),S=m.useMemo(()=>Object.entries({count:t,sortKey:d,query:r,reverse:i}).map(([q,h])=>h?`${q}=${h}`:null).filter(Boolean).join("&"),[t,d,r,i]),j=L(`/api/products?${S}`);return m.useEffect(()=>{u(j)},[u,j]),e.jsxs(e.Fragment,{children:[e.jsx(b,{format:!0,size:"copy",className:"t-4",children:s}),e.jsx("div",{className:x(["grid grid-cols-2 gap-x-6 gap-y-8",n==="page"?"md:grid-cols-4 sm:grid-col-4":""]),children:e.jsx(Q,{count:t,onClick:a,products:l==null?void 0:l.products})})]})}function Q({count:t=4,onClick:s,products:n}){const a=m.useId();return n?(n==null?void 0:n.length)===0?e.jsx(o,{format:!0,children:"No products found."}):e.jsx(e.Fragment,{children:n.map(r=>e.jsx(k,{product:r,onClick:s,quickAdd:!0},r.id))}):e.jsx(e.Fragment,{children:[...new Array(t)].map((r,i)=>e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{className:"aspect-[3/4]"}),e.jsx(f,{className:"w-32 h-4"})]},`${a+i}`))})}function ae({layout:t,onClose:s,cart:n}){var r,i;const a=!!((i=(r=n==null?void 0:n.lines)==null?void 0:r.edges)!=null&&i.length);return e.jsxs(e.Fragment,{children:[e.jsx(G,{hidden:a,onClose:s,layout:t}),e.jsx(T,{cart:n,layout:t})]})}function T({layout:t,cart:s}){const n=!!s&&s.totalQuantity>0,a={drawer:"grid grid-cols-1 h-screen-no-nav grid-rows-[1fr_auto]",page:"w-full pb-12 grid md:grid-cols-2 md:items-start gap-8 md:gap-8 lg:gap-12"};return e.jsxs("div",{className:a[t],children:[e.jsx(O,{lines:s==null?void 0:s.lines,layout:t}),n&&e.jsxs(U,{cost:s.cost,layout:t,children:[e.jsx(D,{discountCodes:s.discountCodes}),e.jsx($,{checkoutUrl:s.checkoutUrl})]})]})}function D({discountCodes:t}){var n;const s=((n=t==null?void 0:t.filter(a=>a.applicable))==null?void 0:n.map(({code:a})=>a))||[];return e.jsxs(e.Fragment,{children:[e.jsx("dl",{className:s&&s.length!==0?"grid":"hidden",children:e.jsxs("div",{className:"flex items-center justify-between font-medium",children:[e.jsx(o,{as:"dt",children:"Discount(s)"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:e.jsx("button",{children:e.jsx(w,{"aria-hidden":"true",style:{height:18,marginRight:4}})})}),e.jsx(o,{as:"dd",children:s==null?void 0:s.join(", ")})]})]})}),e.jsx(g,{discountCodes:s,children:e.jsxs("div",{className:x("flex","items-center gap-4 justify-between text-copy"),children:[e.jsx("input",{className:F(),type:"text",name:"discountCode",placeholder:"Discount code"}),e.jsx("button",{className:"flex justify-end font-medium whitespace-nowrap",children:"Apply Discount"})]})})]})}function g({discountCodes:t,children:s}){return e.jsx(c,{route:"/cart",action:c.ACTIONS.DiscountCodesUpdate,inputs:{discountCodes:t||[]},children:s})}function O({layout:t="drawer",lines:s}){const n=s?P(s):[],a=m.useRef(null),{y:r}=C(a),i=x([r>0?"border-t":"",t==="page"?"flex-grow md:translate-y-4":"px-6 pb-6 sm-max:pt-2 overflow-auto transition md:px-12"]);return e.jsx("section",{ref:a,"aria-labelledby":"cart-contents",className:i,children:e.jsx("ul",{className:"grid gap-6 md:gap-10",children:n.map(d=>e.jsx(_,{line:d},d.id))})})}function $({checkoutUrl:t}){return t?e.jsx("div",{className:"flex flex-col mt-2",children:e.jsx("a",{href:t,target:"_self",children:e.jsx(v,{as:"span",width:"full",children:"Continue to Checkout"})})}):null}function U({cost:t,layout:s,children:n=null}){var r;const a={drawer:"grid gap-4 p-6 border-t md:px-12",page:"sticky top-nav grid gap-6 p-4 md:px-6 md:translate-y-4 bg-primary/5 rounded w-full"};return e.jsxs("section",{"aria-labelledby":"summary-heading",className:a[s],children:[e.jsx("h2",{id:"summary-heading",className:"sr-only",children:"Order summary"}),e.jsx("dl",{className:"grid",children:e.jsxs("div",{className:"flex items-center justify-between font-medium",children:[e.jsx(o,{as:"dt",children:"Subtotal"}),e.jsx(o,{as:"dd","data-test":"subtotal",children:(r=t==null?void 0:t.subtotalAmount)!=null&&r.amount?e.jsx(I,{data:t==null?void 0:t.subtotalAmount}):"-"})]})}),n]})}function _({line:t}){var i,d,u;const s=N(t==null?void 0:t.id);if(!(t!=null&&t.id))return null;const{id:n,quantity:a,merchandise:r}=t;return typeof a>"u"||!(r!=null&&r.product)?null:e.jsxs("li",{className:"flex gap-4",style:{display:(s==null?void 0:s.action)==="remove"?"none":"flex"},children:[e.jsx("div",{className:"flex-shrink",children:r.image&&e.jsx(R,{width:110,height:110,data:r.image,className:"object-cover object-center w-24 h-24 border rounded md:w-28 md:h-28",alt:r.title})}),e.jsxs("div",{className:"flex justify-between flex-grow",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(b,{as:"h3",size:"copy",children:(i=r==null?void 0:r.product)!=null&&i.handle?e.jsx(B,{to:`/products/${r.product.handle}`,children:((d=r==null?void 0:r.product)==null?void 0:d.title)||""}):e.jsx(o,{children:((u=r==null?void 0:r.product)==null?void 0:u.title)||""})}),e.jsx("div",{className:"grid pb-2",children:((r==null?void 0:r.selectedOptions)||[]).map(l=>e.jsxs(o,{color:"subtle",children:[l.name,": ",l.value]},l.name))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex justify-start text-copy",children:e.jsx(H,{line:t})}),e.jsx(M,{lineId:n})]})]}),e.jsx(o,{children:e.jsx(z,{line:t,as:"span"})})]})]},n)}function M({lineId:t}){return e.jsxs(c,{route:"/cart",action:c.ACTIONS.LinesRemove,inputs:{lineIds:[t]},children:[e.jsxs("button",{className:"flex items-center justify-center w-10 h-10 border rounded",type:"submit",children:[e.jsx("span",{className:"sr-only",children:"Remove"}),e.jsx(w,{"aria-hidden":"true"})]}),e.jsx(p,{id:t,data:{action:"remove"}})]})}function H({line:t}){const s=t==null?void 0:t.id,n=N(s);if(!t||typeof(t==null?void 0:t.quantity)>"u")return null;const a=(n==null?void 0:n.quantity)||t.quantity,{id:r}=t,i=Number(Math.max(0,a-1).toFixed(0)),d=Number((a+1).toFixed(0));return e.jsxs(e.Fragment,{children:[e.jsxs("label",{htmlFor:`quantity-${r}`,className:"sr-only",children:["Quantity, ",a]}),e.jsxs("div",{className:"flex items-center border rounded",children:[e.jsx(y,{lines:[{id:r,quantity:i}],children:e.jsxs("button",{name:"decrease-quantity","aria-label":"Decrease quantity",className:"w-10 h-10 transition text-primary/50 hover:text-primary disabled:text-primary/10",value:i,disabled:a<=1,children:[e.jsx("span",{children:"−"}),e.jsx(p,{id:s,data:{quantity:i}})]})}),e.jsx("div",{className:"px-2 text-center","data-test":"item-quantity",children:a}),e.jsx(y,{lines:[{id:r,quantity:d}],children:e.jsxs("button",{className:"w-10 h-10 transition text-primary/50 hover:text-primary",name:"increase-quantity",value:d,"aria-label":"Increase quantity",children:[e.jsx("span",{children:"+"}),e.jsx(p,{id:s,data:{quantity:d}})]})})]})]})}function y({children:t,lines:s}){return e.jsx(c,{route:"/cart",action:c.ACTIONS.LinesUpdate,inputs:{lines:s},children:t})}function z({line:t,priceType:s="regular",...n}){var r,i;if(!((r=t==null?void 0:t.cost)!=null&&r.amountPerQuantity)||!((i=t==null?void 0:t.cost)!=null&&i.totalAmount))return null;const a=s==="regular"?t.cost.totalAmount:t.cost.compareAtAmountPerQuantity;return a==null?null:e.jsx(I,{withoutTrailingZeros:!0,...n,data:a})}function G({hidden:t=!1,layout:s="drawer",onClose:n}){const a=m.useRef(null),{y:r}=C(a),i={drawer:x(["content-start gap-4 px-6 pb-8 transition overflow-y-scroll md:gap-12 md:px-12 h-screen-no-nav md:pb-12",r>0?"border-t":""]),page:x([t?"":"grid","pb-12 w-full md:items-start gap-4 md:gap-8 lg:gap-12"])};return e.jsxs("div",{ref:a,className:i[s],hidden:t,children:[e.jsxs("section",{className:"grid gap-6",children:[e.jsx(o,{format:!0,children:"Looks like you haven’t added anything yet, let’s get you started!"}),e.jsx("div",{children:e.jsx(v,{onClick:n,children:"Continue shopping"})})]}),e.jsx("section",{className:"grid gap-8 pt-16",children:e.jsx(E,{count:4,heading:"Shop Best Sellers",layout:s,onClose:n,sortKey:"BEST_SELLING"})})]})}export{ae as C};
