import{j as e,F as h,u as g,k as N,l as y,O as x,r as b,A as v}from"./components-DpluEorh.js";import{H as w,T as n,s as A,P as O,u as f}from"./Text-DDUC__2Y.js";import{B as j}from"./Button-DLJUwG7J.js";import{L as c}from"./Link-BE_DgB92.js";import{f as d}from"./flatten-connection-BTqmuHGw.js";import{I}from"./Image-CKmnK2hx.js";import{d as P}from"./Icon-D-RzneJA.js";import{P as C}from"./ProductSwimlane-DdyYxUqe.js";import{F}from"./FeaturedCollections-BctkfTDz.js";import"./ProductCard-Bay5aLU-.js";import"./index-D9Zn7Ol-.js";import"./ShopifyProvider-DWJBKkbi.js";import"./Money-EMQwjQIk.js";import"./Grid-CKau4Pvv.js";function S({order:s}){var o,m;if(!(s!=null&&s.id))return null;const[t,a]=s.id.split("/").pop().split("?"),l=d(s==null?void 0:s.lineItems),r=(o=d(s==null?void 0:s.fulfillments)[0])==null?void 0:o.status,i=a?`/account/orders/${t}?${a}`:`/account/orders/${t}`;return e.jsxs("li",{className:"grid text-center border rounded",children:[e.jsxs(c,{className:"grid items-center gap-4 p-4 md:gap-6 md:p-6 md:grid-cols-2",to:i,prefetch:"intent",children:[l[0].image&&e.jsx("div",{className:"card-image aspect-square bg-primary/5",children:e.jsx(I,{width:168,height:168,className:"w-full fadeIn cover",alt:((m=l[0].image)==null?void 0:m.altText)??"Order image",src:l[0].image.url})}),e.jsxs("div",{className:`flex-col justify-center text-left ${!l[0].image&&"md:col-span-2"}`,children:[e.jsx(w,{as:"h3",format:!0,size:"copy",children:l.length>1?`${l[0].title} +${l.length-1} more`:l[0].title}),e.jsxs("dl",{className:"grid grid-gap-1",children:[e.jsx("dt",{className:"sr-only",children:"Order ID"}),e.jsx("dd",{children:e.jsxs(n,{size:"fine",color:"subtle",children:["Order No. ",s.number]})}),e.jsx("dt",{className:"sr-only",children:"Order Date"}),e.jsx("dd",{children:e.jsx(n,{size:"fine",color:"subtle",children:new Date(s.processedAt).toDateString()})}),r&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"sr-only",children:"Fulfillment Status"}),e.jsx("dd",{className:"mt-2",children:e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${r==="SUCCESS"?"bg-green-100 text-green-800":"bg-primary/5 text-primary/50"}`,children:e.jsx(n,{size:"fine",children:A(r)})})})]})]})]})]}),e.jsx("div",{className:"self-end border-t",children:e.jsx(c,{className:"block w-full p-2 text-center",to:i,prefetch:"intent",children:e.jsx(n,{color:"subtle",className:"ml-3",children:"View Details"})})})]})}function k({customer:s}){const{firstName:t,lastName:a,emailAddress:l,phoneNumber:r}=s;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full gap-4 p-4 py-6 md:gap-8 md:p-8 lg:p-12",children:[e.jsx("h3",{className:"font-bold text-lead",children:"Account Details"}),e.jsxs("div",{className:"lg:p-8 p-6 border border-gray-200 rounded",children:[e.jsxs("div",{className:"flex",children:[e.jsx("h3",{className:"font-bold text-base flex-1",children:"Profile"}),e.jsx(c,{prefetch:"intent",className:"underline text-sm font-normal",to:"/account/edit",children:"Edit"})]}),e.jsx("div",{className:"mt-4 text-sm text-primary/50",children:"Name"}),e.jsxs("p",{className:"mt-1",children:[t||a?(t?t+" ":"")+a:"Add name"," "]}),e.jsx("div",{className:"mt-4 text-sm text-primary/50",children:"Phone number"}),e.jsx("p",{className:"mt-1",children:(r==null?void 0:r.phoneNumber)??"N/A"}),e.jsx("div",{className:"mt-4 text-sm text-primary/50",children:"Email address"}),e.jsx("p",{className:"mt-1",children:(l==null?void 0:l.emailAddress)??"N/A"})]})]})})}function D({customer:s,addresses:t}){return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid w-full gap-4 p-4 py-6 md:gap-8 md:p-8 lg:p-12",children:[e.jsx("h3",{className:"font-bold text-lead",children:"Address Book"}),e.jsxs("div",{children:[!(t!=null&&t.length)&&e.jsx(n,{className:"mb-1",width:"narrow",as:"p",size:"copy",children:"You haven't saved any addresses yet."}),e.jsx("div",{className:"w-48",children:e.jsx(j,{to:"address/add",className:"mt-2 text-sm w-full mb-6",variant:"secondary",children:"Add an Address"})}),!!(t!=null&&t.length)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[s.defaultAddress&&e.jsx(p,{address:s.defaultAddress,defaultAddress:!0}),t.filter(a=>{var l;return a.id!==((l=s.defaultAddress)==null?void 0:l.id)}).map(a=>e.jsx(p,{address:a},a.id))]})]})]})})}function p({address:s,defaultAddress:t}){return e.jsxs("div",{className:"lg:p-8 p-6 border border-gray-200 rounded flex flex-col",children:[t&&e.jsx("div",{className:"mb-3 flex flex-row",children:e.jsx("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-primary/20 text-primary/50",children:"Default"})}),e.jsxs("ul",{className:"flex-1 flex-row",children:[(s.firstName||s.lastName)&&e.jsx("li",{children:""+(s.firstName&&s.firstName+" ")+(s==null?void 0:s.lastName)}),s.formatted&&s.formatted.map(a=>e.jsx("li",{children:a},a))]}),e.jsxs("div",{className:"flex flex-row font-medium mt-6 items-baseline",children:[e.jsx(c,{to:`/account/address/${encodeURIComponent(s.id)}`,className:"text-left underline text-sm",prefetch:"intent",children:"Edit"}),e.jsxs(h,{action:"address/delete",method:"delete",children:[e.jsx("input",{type:"hidden",name:"addressId",value:s.id}),e.jsx("button",{className:"text-left text-primary/50 ml-6 text-sm",children:"Remove"})]})]})]})}function z({children:s,cancelLink:t}){return e.jsxs("div",{className:"relative z-50","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",id:"modal-bg",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity bg-opacity-75 bg-primary/40"}),e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsx("div",{className:"flex items-center justify-center min-h-full p-4 text-center sm:p-0",children:e.jsxs("div",{className:"relative flex-1 px-4 pt-5 pb-4 overflow-hidden text-left transition-all transform rounded shadow-xl bg-contrast sm:my-12 sm:flex-none sm:w-full sm:max-w-sm sm:p-6",role:"button",onClick:a=>{a.stopPropagation()},onKeyPress:a=>{a.stopPropagation()},tabIndex:0,children:[e.jsx("div",{className:"absolute top-0 right-0 hidden pt-4 pr-4 sm:block",children:e.jsx(c,{to:t,className:"p-4 -m-4 transition text-primary hover:text-primary/50",children:e.jsx(P,{"aria-label":"Close panel"})})}),s]})})})]})}function X(){const s=g(),t=N(),l=y().some(r=>{const i=r==null?void 0:r.handle;return i==null?void 0:i.renderInModal});return t?l?e.jsxs(e.Fragment,{children:[e.jsx(z,{cancelLink:"/account",children:e.jsx(x,{context:{customer:s.customer}})}),e.jsx(u,{...s})]}):e.jsx(x,{context:{customer:s.customer}}):e.jsx(u,{...s})}function u({customer:s,heading:t,featuredDataPromise:a}){const l=d(s.orders),r=d(s.addresses);return e.jsxs(e.Fragment,{children:[e.jsx(O,{heading:t,children:e.jsx(h,{method:"post",action:f("/account/logout"),children:e.jsx("button",{type:"submit",className:"text-primary/50",children:"Sign out"})})}),l&&e.jsx(E,{orders:l}),e.jsx(k,{customer:s}),e.jsx(D,{addresses:r,customer:s}),!l.length&&e.jsx(b.Suspense,{children:e.jsx(v,{resolve:a,errorElement:"There was a problem loading featured products.",children:i=>e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"Popular Collections",collections:i.featuredCollections}),e.jsx(C,{products:i.featuredProducts})]})})})]})}function E({orders:s}){return e.jsx("div",{className:"mt-6",children:e.jsxs("div",{className:"grid w-full gap-4 p-4 py-6 md:gap-8 md:p-8 lg:p-12",children:[e.jsx("h2",{className:"font-bold text-lead",children:"Order History"}),s!=null&&s.length?e.jsx(B,{orders:s}):e.jsx($,{})]})})}function $(){return e.jsxs("div",{children:[e.jsx(n,{className:"mb-1",size:"fine",width:"narrow",as:"p",children:"You haven't placed any orders yet."}),e.jsx("div",{className:"w-48",children:e.jsx(j,{className:"w-full mt-2 text-sm",variant:"secondary",to:f("/"),children:"Start Shopping"})})]})}function B({orders:s}){return e.jsx("ul",{className:"grid grid-flow-row grid-cols-1 gap-2 gap-y-6 md:gap-4 lg:gap-6 false sm:grid-cols-3",children:s.map(t=>e.jsx(S,{order:t},t.id))})}export{X as default};
